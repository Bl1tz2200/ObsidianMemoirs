[[Lateral Movement]]
#Утилиты
# PsExec в сущности
PsExec - стандартная служебная утилита Windows для удаленного запуска процессов. Он может выполнять процессы от SYSTEM и очень прост для запуска - достаточно скопировать утилиту в нужный каталог
# Принцип работы
Обычно работа PsExec выглядит следующим образом:
1. С помощью SMB перемещают файл PsExesvc.exe (создан PsExec заранее) в сетевую папку ADMIN$ (по умолчанию)
2. Посредством RPC вызывается SCM и создается служба, запускающая наш файл
3. Далее сам файл создает именованный канал для общения с машиной-атакующим
# Методы детектирования
Лучшим по мнению авторов статьи является *способ детектирования на основе событий журнала Windows Security со включенными правилами RPC Filtering*

Детектирование **на сетевом уровне** является проблематичным. Несмотря на полное отображение всех вызовов и событий, **запросы SMB и RPC шифруются**, не позволяя осуществлять полную детекцию

Использование событий **Sysmon** позволяет отслеживать создание всех пайпов, но в нем **не отображено ничего интересного об управлении сервисами или использовании SMB**, вследствие этого Sysmon тоже нельзя использовать как единственный источник для подготовки правил детектирования
### [Источник](https://habr.com/ru/companies/rvision/articles/728838/ )
Представленная информация была взята исходя из статьи на хабре
